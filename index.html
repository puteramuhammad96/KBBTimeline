
<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KBB Timeline — Interactive Dashboard</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsgantt-improved@2.9.3/dist/jsgantt.css">
<link rel="stylesheet" href="./assets/style.css">
</head>
<body>
  <div class="container">
    <div class="header">
      <div>
        <div class="h-title">KBB Steakhouse Project Timeline</div>
        <div class="h-sub" id="subtitle">Kuala Terengganu • Nov–Dec 2025</div>
      </div>
      <div class="controls">
        <div class="chip" id="overall">Overall: 0%</div>
        <div class="btns" id="scale">
          <button data-format="day" class="active">Day</button>
          <button data-format="week">Week</button>
          <button data-format="month">Month</button>
        </div>
      </div>
    </div>

    <div class="grid" style="margin-top:16px">
      <div class="panel">
        <div style="font-size:12px;color:#9ca3af">Cari task</div>
        <input id="search" class="input" placeholder="Contoh: Ceiling, Signage, Plumbing"/>
      </div>
      <div class="panel" style="display:flex;align-items:center;justify-content:space-between">
        <div>
          <div style="font-size:12px;color:#9ca3af">Status</div>
          <div style="font-size:20px;color:#fbbf24" id="statusNum">0%</div>
        </div>
        <div style="text-align:right">
          <div style="font-size:12px;color:#9ca3af">Total Duration</div>
          <div style="font-size:20px" id="duration">—</div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <div class="gantt-wrap">
        <div style="position:relative" class="gantt" id="GanttChartDIV"></div>
      </div>
      <div class="legend">* Klik bar untuk detail. Tukar Day/Week/Month untuk zoom. Filter ikut nama task.</div>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/jsgantt-improved@2.9.3/dist/jsgantt.js"></script>
<script>
const RAW = [["0", "KBB STEAKHOUSE, KUALA TERENGGANU", "2025-11-06", "2025-12-04", 0, 1, 0, ""], ["1", "Site Preparation", "2025-11-06", "2025-11-07", 0, 0, "0", ""], ["2", "Manufacture Site Hoarding", "2025-11-06", "2025-11-06", 0, 0, "1", ""], ["3", "Install Site Hoarding", "2025-11-07", "2025-11-07", 0, 0, "1", "2"], ["4", "Circular Wing (Cover Dining & Toilet)", "2025-11-08", "2025-12-04", 0, 1, "0", "3"], ["5", "Site Delivery", "2025-11-08", "2025-11-11", 0, 0, "4", "3"], ["6", "Marking Demolition Items/Location", "2025-11-08", "2025-11-08", 0, 0, "4", "5"], ["7", "Demolish Floor Finish, Handwash & Steel Cage", "2025-11-08", "2025-11-10", 0, 0, "4", "6"], ["8", "Erect Brickwall Exterior", "2025-11-08", "2025-11-13", 0, 0, "4", "7,5"], ["9", "Plumbing Line for Handwash Area", "2025-11-10", "2025-11-11", 0, 0, "4", "7"], ["10", "Erect Bricks at Toilet (Set Pipe)", "2025-11-11", "2025-11-12", 0, 0, "4", "9"], ["11", "Brickwalls at Photo Area", "2025-11-12", "2025-11-14", 0, 0, "4", "10"], ["12", "Install Fittings at Toilet", "2025-11-13", "2025-11-14", 0, 0, "4", "8"], ["13", "Install Tiles at Toilet", "2025-11-14", "2025-11-16", 0, 0, "4", "12"], ["14", "Brickwalls & Top at Middle Column", "2025-11-14", "2025-11-16", 0, 0, "4", "11"], ["15", "Floor Tiles at Dining Area", "2025-11-16", "2025-11-20", 0, 0, "4", "14"], ["16", "Tiles at Handwash Area", "2025-11-16", "2025-11-18", 0, 0, "4", "13"], ["17", "Measurement for Glass Door", "2025-11-13", "2025-11-14", 0, 0, "4", "8"], ["23", "Ceiling Work (Frame)", "2025-11-18", "2025-11-19", 0, 0, "4", "16"], ["18", "Set Out & Material \u2013 Electrical", "2025-11-19", "2025-11-21", 0, 0, "4", "23"], ["19", "Wiring & Piping Relocation", "2025-11-21", "2025-11-23", 0, 0, "4", "18"], ["20", "Set Out & Material \u2013 Aircond", "2025-11-23", "2025-11-24", 0, 0, "4", "19"], ["21", "Aircond Installation", "2025-11-24", "2025-11-25", 0, 0, "4", "20"], ["37", "Install Ceiling", "2025-11-23", "2025-11-25", 0, 0, "30", "36,35"], ["22", "Plastering Work", "2025-11-25", "2025-11-29", 0, 0, "4", "15,19,37"], ["24", "Ceiling Finishes", "2025-11-25", "2025-11-26", 0, 0, "4", "21,23,39"], ["40", "Paint Work (Main Wing)", "2025-11-25", "2025-11-28", 0, 0, "30", "37"], ["41", "Install Cabinetry (Main Wing)", "2025-11-28", "2025-11-29", 0, 0, "30", "40"], ["25", "Paint Work (Circular Wing)", "2025-11-29", "2025-12-02", 0, 0, "4", "22,24"], ["26", "Install Cabinetry (Circular Wing)", "2025-11-29", "2025-11-30", 0, 0, "4", "41"], ["27", "Install Steel Structure", "2025-11-30", "2025-12-02", 0, 0, "4", "26"], ["28", "Install Signage (Circular Wing)", "2025-12-02", "2025-12-04", 0, 0, "4", "25,27"], ["29", "Install Door", "2025-12-02", "2025-12-04", 0, 0, "4", "28,17"], ["30", "Main Wing", "2025-11-16", "2025-12-04", 0, 1, "0", ""], ["31", "Demolish Floor Finish (Main)", "2025-11-16", "2025-11-19", 0, 0, "30", "15"], ["32", "Demolish Wall Finish to Exposed Brick", "2025-11-16", "2025-11-19", 0, 0, "30", "31"], ["33", "Demolish Ceiling (Main)", "2025-11-16", "2025-11-19", 0, 0, "30", "32"], ["34", "Set Out & Material \u2013 Electrical (Main)", "2025-11-19", "2025-11-21", 0, 0, "30", "31,32,33"], ["35", "Wiring & Piping Relocation (Main)", "2025-11-21", "2025-11-23", 0, 0, "30", "34"], ["36", "Wall Mod (VIP Room \u2013 Shera)", "2025-11-19", "2025-11-22", 0, 0, "30", "31,32,33"], ["38", "Outdoor Touch Up (Demo/Render/Gravel)", "2025-11-19", "2025-11-23", 0, 0, "30", "23"], ["39", "Tiles at Foyer", "2025-11-23", "2025-11-25", 0, 0, "30", "38"], ["42", "Install Signage (Main)", "2025-12-02", "2025-12-04", 0, 0, "30", "41,28"]];

function computeOverall(arr){ 
  const leaf = arr.filter(function(t){ return t[5]===0; });
  if(!leaf.length) return 0;
  var sum = 0; leaf.forEach(function(b){ sum += (b[4]||0); });
  return Math.round(sum/leaf.length);
}

function daysBetween(a,b){
  var da=new Date(a), db=new Date(b);
  return Math.max(1, Math.round((db-da)/86400000));
}

function render(format, query){
  if(!format) format = 'day';
  if(!query) query = '';
  var g = new JSGantt.GanttChart(document.getElementById('GanttChartDIV'), format);
  if( !g.getDivId() ) return;

  g.setOptions({
    vCaptionType:'Complete',
    vShowComp:1,
    vShowStartDate:1, vShowEndDate:1,
    vDateTaskDisplayFormat:'day dd mon yyyy',
    vDayColWidth: 30,
    vWeekColWidth:120,
    vMonthColWidth:180,
    vShowTaskInfoLink:1,
    vUseSort:0,
    vFormat: format,
    vCritical:false
  });

  var filtered = RAW.filter(function(t){ return t[1].toLowerCase().indexOf(query.toLowerCase())>-1; });
  filtered.forEach(function(t){
    var id=t[0], name=t[1], start=t[2], end=t[3], prog=t[4], group=t[5], parent=t[6], dep=t[7];
    g.AddTaskItem(new JSGantt.TaskItem(id, name, start, end, group? 'ggroupblack':'gtaskblue',
      '', 0, '', prog, group, parent, 1, dep, ''));
  });

  g.Draw();
  var proj = RAW.find(function(t){return t[0]==='0';});
  document.getElementById('duration').innerText = daysBetween(proj[2], proj[3]) + ' hari';
  var overall = computeOverall(RAW);
  document.getElementById('overall').innerText = 'Overall: '+overall+'%';
  document.getElementById('statusNum').innerText = overall+'%';
}

render();

document.getElementById('search').addEventListener('input', function(e){
  render(currentFormat, e.target.value);
});

var currentFormat='day';
Array.prototype.forEach.call(document.querySelectorAll('#scale button'), function(btn){
  btn.addEventListener('click', function(){
    Array.prototype.forEach.call(document.querySelectorAll('#scale button'), function(b){ b.classList.remove('active'); });
    btn.classList.add('active');
    currentFormat = btn.getAttribute('data-format');
    render(currentFormat, document.getElementById('search').value || '');
  });
});
</script>
</body>
</html>
